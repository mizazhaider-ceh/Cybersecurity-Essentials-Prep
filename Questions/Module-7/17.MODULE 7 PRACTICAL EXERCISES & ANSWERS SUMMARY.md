# ðŸŽ¯ MODULE 7: PRACTICAL EXERCISES & ANSWERS SUMMARY


***

## ðŸ“š **EXERCISE OVERVIEW**

Module 7 contains **6 practical exercises** covering:

1. Windows Registry investigation
2. File examination and password cracking
3. Malware identification (EICAR test file)
4. Password strength analysis
5. BitLocker encryption
6. Advanced Registry access (SAM keys)

***

## ðŸ” **EXERCISE 1: WINDOWS REGISTRY**

### **Scenario:**

Pentester gains access to PC where normal user has admin privileges (bad practice!)

### **Key Registry Locations:**

**UserAssist (Recently Executed Programs):**

```
\HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\UserAssist
```

- Contains programs executed recently (including time and number of executions!)
- Filenames "encrypted" with **ROT13** (Caesar cipher with key 13)
- ROT13 is reversible: encrypt twice = back to original!

**RecentDocs (Recently Used Files):**

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs
```

- Contains last used files
- Filenames encoded in Hex
- Has subkeys by file extension (.zip, .docx, etc.)


### **Questions \& Answers:**

**Q1: List of .exe programs found (after ROT13 decoding):**

- SnippingTool.exe
- mspaint.exe
- notepad.exe
- D:\\setup64.exe
- cmd.exe
- OpenWith.exe
- C:\\Users\\Keromar\\Desktop\\7z1900-x64.exe
- 7-Zip\\7zG.exe
- 7-Zip\\7zFM.exe
- msiexec.exe
- BitLockerWizard.exe
- fvenotify.exe
- C:\\Sysinternals\\PsExec.exe
- WindowsPowerShell\\v1.0\\powershell.exe
- regedit.exe

**Note:** .lnk files are NOT correct answers (shortcuts, not executables)

**Q2: Which compression program is used?**

- **Answer:** 7-Zip

**Q3: Extension for compressed files?**

- **Answer:** .ZIP

**Q4: How many compressed files in RecentDocs?**

- **Answer:** 6 files

1. eicarcom2.zip
2. fcrackzip-1.0-win32.zip
3. This is a test.zip
4. NewZip.zip
5. test.zip
6. PSTools.zip

***

## ðŸ”“ **EXERCISE 2: EXAMINING FILES \& PASSWORD CRACKING**

### **Files Found:**

5 files without extensions:

- secret
- **PSTools** â† matches list!
- covid-19
- alpha
- **test** â† matches list!


### **Password Cracking with Python:**

**Tool:** `crackpw.py` (Python script for password cracking)

**Two Methods:**

1. **Brute Force** (`-b` argument) - tries all combinations
2. **Dictionary Attack** (`-w` argument) - uses password list

### **Questions \& Answers:**

**Q1: File with shortest name?**

- **Answer:** test

**Q2: Brute force with 4-character password:**

- **Command:** `python crackpw.py -b -l 4 -u 4 -f test.zip`
- **Answer:** 456,976 possible passwords

**Q3: How many passwords in dictionary file?**

- **Answer:** 456,976

**Q4: Which method takes longer?**

- **Answer:** Brute Force (much slower than dictionary!)

**Q5: Password to decrypt file?**

- **Answer:** holy

***

## ðŸ¦  **EXERCISE 3: MALWARE IDENTIFICATION (EICAR)**

### **Scenario:**

File with longest name from Exercise 1 examined in VM environment.

### **Questions \& Answers:**

**Q1: Why can't the file be opened?**

Options:

1. File is empty
2. File is too long for Windows
3. File is damaged
4. File contains malware âœ“

- **Answer:** File contains malware (EICAR test virus)


### **What is EICAR?**

- **EICAR** = European Institute for Computer Antivirus Research
- NOT a real virus - used by antivirus companies to **test their software**
- Demonstrates how encryption can hide malware from security tools until decompressed

**âš ï¸ IMPORTANT:** DELETE FILE FROM COMPUTER AND VM AFTER EXERCISE!

***

## ðŸ”‘ **EXERCISE 4: PASSWORD STRENGTH ANALYSIS**

### **Password from Exercise 2:**

**Pass1** (found in compressed file)

### **Testing Methods:**

**1. Brute Force Test:**

- **Tool:** http://password-checker.online-domain-tools.com/
- Tests how long to crack with different computing power

**2. Dictionary Test:**

- **Tool:** https://haveibeenpwned.com/Passwords
- Checks against 500+ million known passwords


### **Questions \& Answers:**

**Q1: Original password?**

- **Answer:** Pass1

**Q2: Time to crack "Pass1" on Standard Desktop PC?**

- **Answer:** About 9 seconds

**Q3: Time to crack "Pass1Pass1" (doubled) on GPU?**

- **Answer:** About 3 hours

**Q4: Time to crack 'Xa5"bY(4' on medium botnet?**

- **Answer:** About 1 minute

**Q5: How many times has "Pass1" been seen on HaveIbeenpwned?**

- **Answer:** 1,909 times (as of 14/11/2020)

**Q6: Bill Gates email (bill.gates@microsoft.com) breaches?**

- **Answer:** 63 breached sites (as of 14/11/2020)


### **Key Takeaway:**

Current safe password length = **14 characters minimum** (mixing all character types)

***

## ðŸ” **EXERCISE 5: BITLOCKER ENCRYPTION**

### **Requirements:**

- Empty USB drive (will be formatted - all data removed!)


### **Process:**

1. Copy file to USB stick
2. Enable BitLocker on USB drive
3. Set password (protects encryption key)
4. Save recovery key to file
5. Choose "Encrypt used disk space only"
6. Use Compatible encryption method
7. Start encrypting

### **Result:**

- Entire USB disk encrypted with BitLocker
- Password required to access on any computer
- Recovery key saved for emergency access


### **Questions \& Answers:**

**Q1: Number of hex bytes in BitLocker Identifier?**

- **Answer:** 16 hex bytes

**Example Identifier format:**

```
A817B1DC-EB18-4794-9202-43626C82F141
```

**To remove encryption:**

- Format USB stick (removes BitLocker encryption)

***

## ðŸ” **EXERCISE 6: ADVANCED REGISTRY ACCESS (SAM KEYS)**

### **âš ï¸ WARNING:**

**FOR EDUCATIONAL PURPOSES ONLY!**

- Using on other PCs can be dangerous and possibly illegal
- **ONLY DO THIS ON YOUR VM!**


### **Tool Used:**

**PsExec.exe** - Windows command-line tool (Sysinternals)

### **Key Concepts:**

**User Privilege Levels:**

1. **Normal User** - your logged-in account
2. **Administrator** - elevated privileges
3. **NT AUTHORITY\SYSTEM** - highest privileges (more than admin!)

### **SAM Registry Key:**

```
HKEY_LOCAL_MACHINE\SAM
```

- Contains **account information** including usernames
- Hidden even from administrators!
- Need SYSTEM-level access to view


### **Questions \& Answers:**

**Q1: As administrator, how many subkeys under SAM?**

- **Answer:** 1 subkey
- Only see: `SAM\SAM` (second SAM subkey)
- Most data hidden!

**Q2: Using PsExec to elevate to SYSTEM:**

- **Commands:**

```
cd %USERPROFILE%\Desktop
psexec -s -i cmd
whoami
```

- **Answer:** nt authority\system

**Q3: Accessing user names in SAM:**

- **Command:** `psexec -s -i regedit`
- **Location:** `\HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names`
- Now can see **all local users**!

**Proof of access:**

- Navigate to: `HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F5`
- Double-click "F" value
- Find two hex bytes at position 30
- **Answer:** F501 (varies per system)

***

## ðŸŽ¯ **KEY PRACTICAL SKILLS LEARNED**

### **Registry Forensics:**

- âœ… UserAssist shows recently executed programs
- âœ… ROT13 "encryption" (easily reversible)
- âœ… RecentDocs shows recently accessed files
- âœ… Extensions organized in subkeys
- âœ… SAM contains sensitive account data


### **Password Security:**

- âœ… Brute force vs dictionary attacks
- âœ… Short passwords crack in seconds
- âœ… 14+ characters recommended
- âœ… Use HaveIbeenpwned to check compromised passwords
- âœ… Mix all character types


### **File Security:**

- âœ… Encrypted files can hide malware
- âœ… EICAR test file for antivirus testing
- âœ… File extensions can be hidden/changed
- âœ… Always examine files in isolated VM


### **Encryption Practices:**

- âœ… BitLocker for full disk encryption
- âœ… Recovery keys critical for access
- âœ… Encryption protects data at rest
- âœ… USB drives can be encrypted


### **System Access:**

- âœ… Administrator â‰  highest privileges
- âœ… NT AUTHORITY\SYSTEM = god mode
- âœ… PsExec elevates privileges
- âœ… Some registry keys hidden even from admin

***

## ðŸ› ï¸ **TOOLS REFERENCE**

| Tool | Purpose | Usage |
| :-- | :-- | :-- |
| **regedit** | View/edit Windows Registry | `regedit` in search  |
| **CyberChef** | Decode ROT13, hex | https://gchq.github.io/CyberChef/  |
| **crackpw.py** | Crack ZIP passwords | `python crackpw.py -b -l 4 -u 4 -f file.zip`  |
| **Password Checker** | Test password strength | http://password-checker.online-domain-tools.com/  |
| **HaveIbeenpwned** | Check compromised passwords | https://haveibeenpwned.com/  |
| **BitLocker** | Disk encryption | Drive Tools â†’ BitLocker  |
| **PsExec** | Elevate to SYSTEM | `psexec -s -i cmd`  |
| **whoami** | Check current user | `whoami` in cmd  |


***

## ðŸ“Š **QUICK REFERENCE ANSWERS**

**Exercise 1:**

- Compression program: 7-Zip
- Compressed file extension: .ZIP
- Number of ZIP files found: 6

**Exercise 2:**

- Shortest filename: test
- Possible passwords (4 chars): 456,976
- Slower method: Brute Force
- Cracked password: holy

**Exercise 3:**

- Why file won't open: Contains malware (EICAR test)

**Exercise 4:**

- Original password: Pass1
- Time to crack (desktop): ~9 seconds
- Time to crack doubled (GPU): ~3 hours
- Times seen on breach list: 1,909
- Bill Gates breaches: 63

**Exercise 5:**

- BitLocker Identifier hex bytes: 16

**Exercise 6:**

- SAM subkeys (admin view): 1
- Elevated user: nt authority\system
- Hex bytes at position 30: F501 (example)

***

## ðŸ’¡ **SECURITY LESSONS**

1. **Registry contains forensic goldmine** - tracks user activity extensively
2. **ROT13 is NOT encryption** - trivially broken
3. **Short passwords are dangerous** - crack in seconds even with complexity
4. **Encryption can hide threats** - until decompressed/decrypted
5. **14+ character passwords** - current minimum for security
6. **Check breached passwords** - use HaveIbeenpwned
7. **BitLocker protects data at rest** - essential for portable devices
8. **SYSTEM > Administrator** - Windows has multiple privilege levels
9. **Always test in VM** - never risk production systems
10. **Security requires constant vigilance** - tools and techniques constantly evolving

***

## ðŸŽ“ **EXAM RELEVANCE**

These exercises teach **PRACTICAL SKILLS** tested in:

- Windows Registry forensics
- Password cracking techniques
- Malware identification
- Encryption implementation
- Privilege escalation
- System-level access

**You now have hands-on experience with:**

- Penetration testing methodology
- Digital forensics
- Password security assessment
- Encryption deployment
- Advanced Windows administration

***

## ðŸš€ **GRAND TOTAL: 2,230+ QUESTIONS + PRACTICAL LABS!**

âœ… Module 1 - Concepts I: 160 questions
âœ… Module 1 - Concepts II: 210 questions
âœ… Module 2 - Policies: 180 questions
âœ… Module 3 - Encoding \& Modulo: 120 questions
âœ… Module 3 - Information Flow: 200 questions
âœ… Module 4 - Encryption \& Hashing: 200 questions
âœ… Module 5 - Math of Cryptography: 260 questions
âœ… Module 5 - Scripting: 100 questions
âœ… Module 6 - Risk Management: 200 questions
âœ… Module 7a - LAN and Desktop: 220 questions
âœ… Module 7b - Application and Data: 180 questions
âœ… **Module 7 - Practical Labs: 6 comprehensive exercises**

**YOU'VE MASTERED BOTH THEORY AND PRACTICE, Champ!** ðŸ”¥ðŸš€ðŸ’»

These hands-on exercises give you **real-world cybersecurity skills** that complement your theoretical knowledge perfectly! You're not just learning concepts - you're **doing actual penetration testing, forensics, and security analysis**! ðŸ’ª
