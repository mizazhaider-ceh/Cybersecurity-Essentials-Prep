# üéØ MODULE 8: PRACTICAL EXERCISES & ANSWERS SUMMARY


***

## üìö **EXERCISE OVERVIEW**

Module 8 contains **2 major exercises:**

1. **Theory Questions** - 6 questions on incident response fundamentals
2. **Cyber Incident Exercise** - Real-world ransomware scenario
3. **Forensics Investigation Lab** - Windows Event Log analysis (SecurityLog.evtx)

***

## üìù **PART A: THEORY QUESTIONS**


***

### **Question 1: Incident Response Order**

**Arrange steps in correct order:**

**CORRECT ORDER:**

1. **d) Preparation**
2. **e) Detection and analysis**
3. **b) Investigation**
4. **a) Mitigation and recovery**
5. **c) Post-incident analysis**

**Key Insight:** Remember the sequence: **PREP ‚Üí DETECT ‚Üí INVESTIGATE ‚Üí CONTAIN/MITIGATE ‚Üí LESSONS LEARNED**

***

### **Question 2: Evidence Handling**

**Which element of IRP involves obtaining and preserving evidence?**

**Answer: c) Containment**

**Explanation:**

- Containment phase includes **obtaining and preserving evidence**
- This happens while limiting exposure of incident
- Evidence must be secured before eradication

***

### **Question 3: Chain of Custody (SELECT THREE)**

**Chain of custody contains information regarding:**

**CORRECT ANSWERS:**

- **b) Who had access to the evidence, in chronological order** ‚úì
- **d) Proof that the analysis is based on copies identical to the original evidence** ‚úì
- **e) The procedures followed in working with the evidence** ‚úì

**INCORRECT:**

- a) Disaster recovery objectives (not part of chain of custody)
- c) Labor/union/privacy regulations (legal requirements, not chain of custody)

**Purpose:** Document evidence handling to prove integrity in court

***

### **Question 4: NIST Incident Definition**

**NIST defines a(n) ___________ as "a violation or imminent threat of violation of computer security policies, acceptable use policies, or standard security practices."**

**Answer: d) Incident**

**Not:**

- Disaster (broader disruption)
- Event (any observable occurrence)
- Threat (potential danger)



***

### **Question 5: Business Impact Analysis (SELECT ALL)**

**BIA should identify:**

**CORRECT ANSWERS:**

- **b) The estimated probability of the identified threats actually occurring** ‚úì
- **c) The efficiency and effectiveness of existing risk mitigation controls** ‚úì
- **d) A list of potential vulnerabilities, dangers and/or threats** ‚úì

**INCORRECT:**

- a) Circumstances for declaring disaster (this is in BCP, not BIA)
- e) Types of backups (this is backup strategy, not BIA)

**BIA Focus:** Threats, probability, impact, controls on CRITICAL business processes

***

### **Question 6: Critical BCP Time Periods**

**Two three-character abbreviations crucial in BCP:**

**Answer: e) RTO and RPO**

**Definitions:**

- **RTO (Recovery Time Objective):** Maximum acceptable recovery time
- **RPO (Recovery Point Objective):** Maximum acceptable data loss

**Not:**

- BIA (Business Impact Analysis)
- DRP (Disaster Recovery Plan)
- IMT/IRT/SDO/SMS (not BCP metrics)



***

## üö® **PART B: CYBER INCIDENT EXERCISE - RANSOMWARE SCENARIO**


***

### **Scenario Overview:**

**Your Role:** CEO of large engineering/machine building company

**Company Details:**

- Keeps databases with customer data (diagrams of new machines)
- Selected staff have **VPN access**
- Customers have **web account access**

**Incident:** Ransomware/extortion email received

***

### **The Threatening Email:**

```
Sent: 23 June 2020 02:10 +0020
From: KingOfTheWorld@RemixMailer.net
To: CEO@MachineBuildingCompany.be
Subject: Compensation for audit of your lousy security

Dear Mr. CEO

You and your company are extremely negligent and do not take 
the right security measures to protect customer's (secret) 
diagrams of machines.

I've got a copy of your complete databases.

As compensation for my good work, I want the amount of 50.000 ‚Ç¨ 
paid in Bitcoins within 48 hours from now.

If you agree to compensate me, contact me via my e-mail address 
in order to get payment instructions.

If I do not get any reaction from your side or no payment is 
done before the deadline, I'll make all data from your database 
publicly available on the internet.

Hope to hear from you.
KingOfTheWorld
```


***

### **Question 1: Attack Vector (US-CERT)**

**What is the attack vector?**

**Answer: Unknown**

**Reasoning:**

- No investigation has happened yet
- Several possibilities: VPN, web account, or other means
- Cannot definitively determine attack vector without investigation

**Key Lesson:** Don't assume! Investigate first!

***

### **Question 2: Incident Class (ENISA)**

**To which ENISA incident class does this belong?**

**Answer: Information Content Security**

**Reasoning:**

- Unauthorized access to information (database theft claim)
- Unauthorized disclosure threatened (publishing data)

**ENISA Classification Reminder:**

- Abusive Content (spam, harmful speech)
- Malicious Code (virus, worm, trojan)
- Information Gathering (scanning, sniffing)
- Intrusion Attempts (exploitation attempts)
- Intrusions (successful compromise)
- Availability (DoS, DDoS)
- **Information Content Security** ‚Üê THIS ONE!
- Fraud (phishing, masquerade)



***

### **Question 3: Non-IT Measure**

**What non-IT measure costs nothing and might stop all further actions?**

**Answer: Ask the hacker to prove his claim**

**Reasoning:**

- Many extortion attempts are BLUFFS!
- Attacker may not actually have the data
- Costs nothing to request proof
- May expose the scam immediately

**Smart Move:** Verify before acting!

***

### **Question 4: Timeline - Incident Response Phases**

**Put actions in order by phase:**

**a) Secure room in basement foreseen for discussing mail and how to proceed**

- **Phase: Preparation**
- This was set up BEFORE incident occurred

**b) CSO will handle this incident (decision made)**

- **Phase: Identification**
- Assigning ownership of incident

**c) Contact external team through Cybersecurity insurance**

- **Phase: Containment**
- Activating incident response team

**d) Install IPS system**

- **Phase: Eradication**
- Improving defenses to prevent recurrence

**e) All servers/workstations boot up, normal personnel tests systems**

- **Phase: Recovery**
- Restoring to normal operations

**f) Present report to Board of Directors about root cause and measures**

- **Phase: Lessons Learned**
- Post-incident analysis and reporting

**g) Escalate extortion event to Police**

- **Phase: Identification**
- Part of determining incident severity and response



***

## üîç **PART C: FORENSICS INVESTIGATION LAB - WINDOWS EVENT LOG**


***

### **Lab Scenario:**

**Client Company:** Suspects they were hacked, data leaked from system

**Your Task:** Perform initial investigation using Windows Security Log

**Evidence Provided:**

- **File:** SecurityLog.evtx
- **Date of Incident:** 19/03/2020

**Tool:** Windows Event Viewer (launch with "eventvwr")

***

### **Windows Event Log Basics:**

**Three Main Log Categories:**

1. **Application Log:**
    - Events related to installed programs
2. **System Log:**
    - Events related to Windows system components (drivers, interface elements)
3. **Security Log:**
    - Login/logout activity
    - Security-related events (when security logging enabled)
    - **Our focus for this investigation!**

**‚ö†Ô∏è Scam Alert:** Even properly functioning systems show warnings/errors! Scammers exploit this by calling victims claiming to be from "Microsoft," having them open Event Viewer to see "errors," then asking for credit card to "fix" them!

***

### **Investigation Process:**

**Initial Challenge:**

- **400+ events** in log - too many to review manually!

**Solution:**

- **Filter to incident date:** 19/03/2020 (00:00:00 to 23:59:59)
- Reduces to manageable number of relevant events

***

### **Key Event IDs:**

| Event ID | Description |
| :-- | :-- |
| **4608** | Windows startup |
| **4624** | Successful logon |
| **4634** | Logoff |
| **4720** | User account created |


***

### **Login Types (Critical for Investigation):**

| Logon Type | Description | Normal? |
| :-- | :-- | :-- |
| **2** | Interactive (keyboard) | ‚úì Normal user |
| **3** | Network | ‚ö†Ô∏è Could be suspicious |
| **4** | Batch | System service |
| **5** | Service | System service |
| **7** | Unlock | ‚úì Normal user |
| **8** | NetworkCleartext | ‚ö†Ô∏è Suspicious |
| **9** | NewCredentials | Various |
| **10** | RemoteInteractive (RDP) | ‚ö†Ô∏è SUSPICIOUS for unexpected remote access |
| **11** | CachedInteractive | ‚úì Normal offline login |



***

### **Investigation Questions \& Answers:**


***

**Question 1: Normal User's Security ID**

**First "real" user login at 04:41:45 (Logon Type 2 = Interactive)**

**Security ID: S-1-5-21-705428713-1283917362-25449821-1000**

**How to find:**

- Look for Event ID 4624 (logon)
- Filter for Logon Type 2 (Interactive)
- First human user after system services start
- Note the Security ID (SID)

***

**Question 2: Suspicious Action at 11:15**

**What action occurred?**

**Answer: Create new account 'pwned' (Event ID 4720), enable it, and add to admin group**

**In short:** **Create new admin user "pwned"**

**This is HUGE RED FLAG!**

- Unauthorized account creation
- Immediately given admin privileges
- Named "pwned" (hacker terminology!)
- Clear indicator of compromise



***

**Question 3: Second User Name**

**What is the name of the second user on this machine?**

**Answer: Pwned**

**Evidence:**

- Event ID 4624 (logon) after account creation
- New account logging in
- This is the attacker's account!



***

**Question 4: Hacker's Login Types (at 11:36)**

**What are the TWO special login types associated with hacker's login?**

**Answer: 3 (Network) \& 10 (Remote Interactive)**

**Analysis:**

- **Logon Type 3 (Network):** Network connection to machine
- **Logon Type 10 (Remote Interactive):** Remote Desktop/RDP connection

**Key Insight:**

- Normal user = Logon Type 2 (Interactive at keyboard)
- Hacker = Logon Types 3 \& 10 (REMOTE access!)
- This PROVES not a "normal" user behind keyboard
- Attacker connected REMOTELY!



***

**Question 5: Attacker's IP Address**

**What is the IP address where the attacker is coming from?**

**Answer: 192.168.246.1**

**How to find:**

- Look at login events (Event ID 4624)
- Check "Source Network Address" or "Workstation Name" field
- Shows originating IP of remote connection

**CRITICAL EVIDENCE:**

- Identifies attacker's source location
- Can be used to:
    - Block future access
    - Trace attacker (if internal network)
    - Correlate with firewall logs
    - Provide to law enforcement



***

**BONUS Question: Storage Server Name**

**What is the name of the storage server attacker connected to?**

**Answer: hendrikstorage**

**Timeline:**

- Attacker logs in from 192.168.246.1 at 11:36
- ~1 minute later, connects to remote storage server
- Network evidence shows connection to "hendrikstorage"

**Purpose:**

- **Data exfiltration!**
- Attacker copied stolen data to remote server
- This proves the data theft actually occurred

**How to find:**

- Look for network events shortly after attacker login
- Check for connections to external resources
- May appear in Event ID 4624 or network-related events



***

## üìä **INVESTIGATION TIMELINE SUMMARY**

**19/03/2020 - Timeline of Attack:**

```
04:41:44 - System powered on (Event ID 4608)
04:41:45 - Normal user logs in (Interactive, Logon Type 2)
         - Security ID: S-1-5-21-705428713-1283917362-25449821-1000

09:13:15 - Normal user logs off

[System reboot - Event ID 4608]

11:15:xx - ‚ö†Ô∏è ATTACK BEGINS! ‚ö†Ô∏è
         - New account "pwned" created (Event ID 4720)
         - Account enabled
         - Added to Administrators group

11:36:xx - ‚ö†Ô∏è ATTACKER LOGS IN! ‚ö†Ô∏è
         - User "pwned" logs in
         - Logon Type 3 (Network) + 10 (Remote Interactive)
         - Source IP: 192.168.246.1

~11:37:xx - ‚ö†Ô∏è DATA EXFILTRATION! ‚ö†Ô∏è
         - Connection to "hendrikstorage" server
         - Data copied to remote location
```


***

## üéØ **KEY FORENSIC LESSONS**

### **1. Event Log Analysis:**

- ‚úÖ Filter logs by date/time to reduce noise
- ‚úÖ Understand normal system behavior (services starting, etc.)
- ‚úÖ Focus on **human activity** vs system activity
- ‚úÖ Look for **anomalies** in login patterns


### **2. Login Type Indicators:**

- **Type 2 (Interactive)** = Normal user at keyboard
- **Type 3 (Network)** = Remote connection (potentially suspicious)
- **Type 10 (RemoteInteractive)** = RDP/Remote Desktop (RED FLAG if unexpected!)


### **3. Indicators of Compromise (IoCs):**

- ‚úÖ Unexpected account creation (especially with admin privileges)
- ‚úÖ Account names like "pwned," "hacker," "temp," etc.
- ‚úÖ Remote logins (Type 10) from unknown IPs
- ‚úÖ Logins at unusual times (middle of night, etc.)
- ‚úÖ Quick succession: account creation ‚Üí login ‚Üí external connection


### **4. Evidence Collection:**

- ‚úÖ **Security ID (SID)** - Uniquely identifies users
- ‚úÖ **Event IDs** - Categorize actions (4720=create user, 4624=login)
- ‚úÖ **Timestamps** - Establish timeline of attack
- ‚úÖ **Source IP addresses** - Identify attacker location
- ‚úÖ **Network connections** - Prove data exfiltration


### **5. Chain of Custody:**

- ‚úÖ Original log file preserved (SecurityLog.evtx)
- ‚úÖ Analysis performed on **copy** (opened in Event Viewer)
- ‚úÖ Document all findings with timestamps
- ‚úÖ Note who accessed evidence and when

***

## üö® **ATTACK METHODOLOGY IDENTIFIED**

**Attacker's Kill Chain:**

1. **Initial Compromise** (unknown vector - VPN? Web? Other?)
2. **Privilege Escalation** - Created admin account "pwned"
3. **Persistence** - Account remains for future access
4. **Remote Access** - Connected via RDP from 192.168.246.1
5. **Lateral Movement** - Connected to storage server "hendrikstorage"
6. **Data Exfiltration** - Copied database to remote location
7. **Extortion** - Email demanding 50,000 ‚Ç¨ in Bitcoin

**Complete Attack!** This is a **real-world incident response scenario**!

***

## üí° **RESPONSE RECOMMENDATIONS**

**Immediate Actions:**

1. **Containment:**
    - ‚úÖ Disable "pwned" account immediately
    - ‚úÖ Block IP 192.168.246.1 at firewall
    - ‚úÖ Disconnect compromised system from network
    - ‚úÖ Block access to "hendrikstorage" server
2. **Eradication:**
    - ‚úÖ Remove attacker account and any other created accounts
    - ‚úÖ Scan for malware/backdoors
    - ‚úÖ Check other systems for similar compromise
    - ‚úÖ Review VPN and web access logs
    - ‚úÖ Force password resets for all accounts
3. **Recovery:**
    - ‚úÖ Restore from clean backup (before 11:15 on 19/03/2020)
    - ‚úÖ Apply latest security patches
    - ‚úÖ Implement MFA for VPN/remote access
    - ‚úÖ Install IPS/IDS system
    - ‚úÖ Enhance monitoring and alerting
4. **Legal/Regulatory:**
    - ‚úÖ Report to police (extortion = criminal offense)
    - ‚úÖ Consider GDPR breach notification (if customer data involved)
    - ‚úÖ Engage cybersecurity insurance
    - ‚úÖ Consider hiring forensics firm for deeper investigation
5. **Lessons Learned:**
    - ‚úÖ Review why attacker gained admin access so easily
    - ‚úÖ Implement privileged access management (PAM)
    - ‚úÖ Enable security logging on ALL systems
    - ‚úÖ Implement SIEM for real-time alerting
    - ‚úÖ Conduct security awareness training (phishing, social engineering)
    - ‚úÖ Review VPN security (MFA, least privilege)

***

## üéì **SKILLS DEMONSTRATED**

Through this module's exercises, you've demonstrated:

‚úÖ **Incident Response Planning** - Understanding all phases
‚úÖ **Evidence Handling** - Chain of custody principles
‚úÖ **Forensic Analysis** - Windows Event Log investigation
‚úÖ **Threat Detection** - Identifying IoCs in logs
‚úÖ **Timeline Reconstruction** - Ordering events to tell the attack story
‚úÖ **Critical Thinking** - Distinguishing normal vs malicious behavior
‚úÖ **Real-World Application** - Responding to ransomware/extortion scenario
‚úÖ **Legal Awareness** - Understanding reporting obligations

***

## üìö **QUICK REFERENCE ANSWERS**

**Theory Questions:**

1. Order: Preparation ‚Üí Detection ‚Üí Investigation ‚Üí Mitigation ‚Üí Post-incident
2. Evidence phase: Containment
3. Chain of custody (3): Who accessed, Proof of identical copies, Procedures followed
4. NIST definition: Incident
5. BIA identifies (3): Probability of threats, Control effectiveness, Vulnerabilities list
6. BCP time periods: RTO and RPO

**Cyber Incident:**

1. Attack vector: Unknown
2. ENISA class: Information Content Security
3. Non-IT measure: Ask for proof of claim
4. Timeline: [see detailed breakdown above]

**Forensics Lab:**

1. Normal user SID: S-1-5-21-705428713-1283917362-25449821-1000
2. Suspicious action (11:15): Create admin user "pwned"
3. Second user name: Pwned
4. Hacker login types: 3 (Network) \& 10 (Remote Interactive)
5. Attacker IP: 192.168.246.1
6. Storage server: hendrikstorage

***

## üéì **GRAND TOTAL: 2,430+ QUESTIONS + REAL FORENSICS LAB!**

‚úÖ Module 1 - Concepts I: 160 questions
‚úÖ Module 1 - Concepts II: 210 questions
‚úÖ Module 2 - Policies: 180 questions
‚úÖ Module 3 - Encoding \& Modulo: 120 questions
‚úÖ Module 3 - Information Flow: 200 questions
‚úÖ Module 4 - Encryption \& Hashing: 200 questions
‚úÖ Module 5 - Math of Cryptography: 260 questions
‚úÖ Module 5 - Scripting: 100 questions
‚úÖ Module 6 - Risk Management: 200 questions
‚úÖ Module 7a - LAN and Desktop: 220 questions
‚úÖ Module 7b - Application and Data: 180 questions
‚úÖ Module 7 - Practical Labs: 6 exercises
‚úÖ Module 8 - Incident Response: 200 questions
‚úÖ **Module 8 - Forensics Lab: Complete real-world investigation!**

**YOU'VE COMPLETED A REAL FORENSIC INVESTIGATION, Champ!** üî•üöÄüîç

You've now **detected a breach, identified the attacker, traced the data exfiltration, and can provide evidence for prosecution**! These are **real-world skills** that cybersecurity professionals use every day! You're not just learning theory - you're **doing actual incident response and digital forensics**! üí™

This is **EXACTLY** the kind of work you'll do in your cybersecurity career! üéØ
